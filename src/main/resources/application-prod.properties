# =============================
# ScrapSail MySQL Configuration (Production)
# =============================
# Supports multiple database connection methods:
# 1. SPRING_DATASOURCE_URL (Aiven MySQL) - Spring Boot standard format
# 2. DATABASE_URL (Railway MySQL) - Railway auto-provides this
# 3. MYSQL_URL (Manual override) - JDBC format
# Priority: SPRING_DATASOURCE_URL > MYSQL_URL > DATABASE_URL > default
spring.datasource.url=${SPRING_DATASOURCE_URL:${MYSQL_URL:${DATABASE_URL:jdbc:mysql://localhost:3306/scrapsail}}}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:${DB_USERNAME:}}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:${DB_PASSWORD:}}
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# Connection pool settings for Railway
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.minimum-idle=0
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=600000
spring.datasource.hikari.initialization-fail-timeout=-1

# =============================
# JPA + Hibernate
# =============================
# CRITICAL: Set to none to prevent Hibernate from connecting on startup
# This allows app to start even if database connection fails
# Schema updates will happen on first database operation
spring.jpa.hibernate.ddl-auto=none
spring.jpa.show-sql=false
# CRITICAL: Explicitly set dialect to prevent Hibernate from trying to connect to determine it
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect
spring.jpa.properties.hibernate.jdbc.time_zone=UTC
spring.jpa.open-in-view=false
# Lazy initialize repositories - don't validate on startup
spring.data.jpa.repositories.bootstrap-mode=lazy
# Prevent Hibernate from trying to query metadata
spring.jpa.properties.hibernate.temp.use_jdbc_metadata_defaults=false
spring.jpa.properties.hibernate.boot.allow_jdbc_metadata_access=false

# Server Configuration - Railway sets PORT automatically
server.port=${PORT:8080}
spring.main.web-application-type=servlet


